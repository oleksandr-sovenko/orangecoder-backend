<!--
dashboard.f7.html
Copyright (C) 2019 Oleksandr Sovenko (info@oleksandrsovenko.com)

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
-->


<template>
    <div class="page" data-name="dashboard">
        <!-- Top Navbar -->
        <div class="navbar">
            <div class="navbar-bg"></div>
            <div class="navbar-inner">
                <div class="left">
                    <a href="#" class="link icon-only panel-open" data-panel="left">
                        <i class="material-icons">menu</i>
                    </a>
                </div>
                <div class="title">{{_t 'Dashboard'}}</div>
            </div>
        </div>
        <div class="page-content">
            <div class="block-title">{{device.platform}} {{device.version}} <span class="float-right">{{_t 'Uptime'}} <span class="info-uptime">-</span></span></div>

            <div class="card">
                <div class="card-header">
                    {{_t 'Board'}} "{{device.model}}"
                </div>
                <div class="card-content">
                    <div class="row">
                        <div class="col-40" style="padding: 15px;">
                            <figure>{{device.scheme}}</figure>
                        </div>
                        <div class="col-60" style="padding: 15px;">
                            <table width="100%" cellpadding="0" cellspacing="0">
                                <thead>
                                    <tr>
                                        <th>H2+</th>
                                        <th>wPi</th>
                                        <th>Name</th>
                                        <th>Mode</th>
                                        <th>V</th>
                                        <th colspan="2">Physical</th>
                                        <th>V</th>
                                        <th>Mode</th>
                                        <th>Name</th>
                                        <th>wPi</th>
                                        <th>H2+</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {{#each device.gpio}}
                                        <tr>
                                            <td class="pin pin-{{left['Physical']}}">{{left['H2+']}}</td>
                                            <td class="pin pin-{{left['Physical']}}">{{left['wPi']}}</td>
                                            <td class="pin pin-{{left['Physical']}}">{{left['Name']}}</td>
                                            <td class="pin pin-{{left['Physical']}}">{{left['Mode']}}</td>
                                            <td class="pin pin-{{left['Physical']}}">{{left['V']}}</td>
                                            <td class="pin pin-{{left['Physical']}}"><b>{{left['Physical']}}</b></td>
                                            <td class="pin pin-{{right['Physical']}}"><b>{{right['Physical']}}</b></td>
                                            <td class="pin pin-{{right['Physical']}}">{{right['V']}}</td>
                                            <td class="pin pin-{{right['Physical']}}">{{right['Mode']}}</td>
                                            <td class="pin pin-{{right['Physical']}}">{{right['Name']}}</td>
                                            <td class="pin pin-{{right['Physical']}}">{{right['wPi']}}</td>
                                            <td class="pin pin-{{right['Physical']}}">{{right['H2+']}}</td>
                                        </tr>
                                    {{/each}}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    {{_t 'CPU'}}
                </div>
                <div class="card-content">
                    <div class="block mt10 pb10">
                        <div class="row">
                            <div class="col text-align-center cpu-usage">
                                <div
                                  class="gauge-init cpu-usage-0"
                                  data-type="semicircle"
                                  data-value="0"
                                  data-value-text="0%"
                                  data-value-text-color="green"
                                  data-border-color="green"
                                ></div>
                            </div>
                            <div class="col text-align-center cpu-usage">
                                <div
                                  class="gauge-init cpu-usage-1"
                                  data-type="semicircle"
                                  data-value="0"
                                  data-value-text="0%"
                                  data-value-text-color="green"
                                  data-border-color="green"
                                ></div>
                            </div>
                            <div class="col text-align-center cpu-usage">
                                <div
                                  class="gauge-init cpu-usage-2"
                                  data-type="semicircle"
                                  data-value="0"
                                  data-value-text="0%"
                                  data-value-text-color="green"
                                  data-border-color="green"
                                ></div>
                            </div>
                            <div class="col text-align-center cpu-usage">
                                <div
                                  class="gauge-init cpu-usage-3"
                                  data-type="semicircle"
                                  data-value="0"
                                  data-value-text="0%"
                                  data-value-text-color="green"
                                  data-border-color="green"
                                ></div>
                            </div>
                        </div>
                        <p>{{_t 'Temperature'}}</p>
                        <div>
                            <p><span data-progress="0" class="progressbar cpu-temperature"></span></p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    {{_t 'Usage'}}
                </div>
                <div class="card-content">
                    <div class="block mt10 pb10">
                        <div class="row">
                            <div class="col">
                                <p>{{_t 'Disk'}}</p>
                                <div>
                                    <p><span data-progress="0" class="progressbar disk-usage"></span></p>
                                </div>
                            </div>
                            <div class="col">
                                <p>{{_t 'RAM'}}</p>
                                <div>
                                    <p><span data-progress="0" class="progressbar ram-usage"></span></p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    {{_t 'Network Interfaces'}}
                </div>
                <div class="card-content">
                    <div class="block mt10 pb10 info-network">{{_t 'Loading'}} ...</div>
                </div>
            </div>
        </div>
    </div>
</template>


<script>
export default {
    style: `
        .page[data-name="dashboard"] [data-pin] {
            cursor: pointer;
        }

        .page[data-name="dashboard"] th {
            background: #f3943d;
            color: white;
            padding: 3px;
        }

        .page[data-name="dashboard"] td {
            text-align: center;
            padding: 3px;
        }

        .page[data-name="dashboard"] tr:nth-child(even) {
            background: #f3f3f3
        }

        .page[data-name="dashboard"] tr:nth-child(odd) {
            background: #fff
        }

        .page[data-name="dashboard"] .pin-active {
            background: #f3943da6;
            color: white;
        }
    `,
  	on: {
        pageInit: function(e, page) {
            const   self = this,
                    $$   = self.$$,
                    app  = self.$app;

        	app.methods.getDevice(function(response) {
                self.device = response;
                self.$update();
        	});
        }
    },

    data: function() {
        return {
            device: { platform: 'Loading', version: '...' }
        }
    },

    mounted() {
        const   self = this,
                $$   = self.$$,
                app  = self.$app,
                page = self.$el;

        page.on('mouseover', 'circle[data-pin]', function() {
            var el = $$(this),
                pin = el.attr('data-pin');

            page.find('.pin-' + pin).addClass('pin-active');
        });

        page.on('mouseout', '[data-pin]', function() {
            page.find('.pin').removeClass('pin-active');
        });
    }
}
</script>